# -*- coding: utf-8 -*-
class Solution(object):
    def findMinHeightTrees(self, n, edges):
        """
        Solution: BFS (TLE)
        Time Complexity: O(n^2)
        Space Complexity: O(3n)
        Inspired By: MySELF!!
        TP:
        - WHY O(n^2) --> cause we visit every node
        :type n: int
        :type edges: List[List[int]]
        :rtype: List[int]
        """
        if not edges or not edges[0] or n == 0: return [0]
        tree = dict()
        for i, j in edges:
            _tmp = tree.get(i, [])
            _tmp.append(j)
            tree[i] = _tmp
            _tmp = tree.get(j, [])
            _tmp.append(i)
            tree[j] = _tmp
        min_level = float('inf')
        res = []
        for i in range(n):
            if len(tree[i]) != 1 or len(tree) == 2:
                q = [i]
                visited = set()
                level = 0
                while q:
                    for _ in range(len(q)):
                        curr_node = q.pop(0)
                        if curr_node not in visited:
                            q += tree[curr_node]
                            visited.add(curr_node)
                    level += 1
                    if level > min_level:
                        break
                if level < min_level:
                    min_level = level
                    res = [i]
                elif level == min_level:
                    res.append(i)
        return res

#n = 4
#edges = [[1, 0], [1, 2], [1, 3]]

#n = 909
#edges = [[0,1],[0,2],[2,3],[0,4],[4,5],[0,6],[6,7],[0,8],[7,9],[1,10],[0,11],[10,12],[8,13],[3,14],[1,15],[1,16],[4,17],[7,18],[15,19],[1,20],[14,21],[9,22],[14,23],[15,24],[7,25],[0,26],[24,27],[13,28],[22,29],[18,30],[18,31],[17,32],[14,33],[20,34],[1,35],[14,36],[14,37],[30,38],[13,39],[6,40],[32,41],[17,42],[23,43],[23,44],[6,45],[27,46],[9,47],[4,48],[16,49],[31,50],[21,51],[21,52],[31,53],[53,54],[18,55],[3,56],[7,57],[52,58],[14,59],[10,60],[20,61],[17,62],[2,63],[36,64],[25,65],[53,66],[61,67],[23,68],[14,69],[29,70],[63,71],[12,72],[6,73],[11,74],[73,75],[60,76],[38,77],[61,78],[71,79],[20,80],[24,81],[60,82],[52,83],[68,84],[22,85],[36,86],[85,87],[9,88],[15,89],[56,90],[16,91],[67,92],[24,93],[63,94],[41,95],[57,96],[83,97],[90,98],[38,99],[54,100],[97,101],[4,102],[51,103],[31,104],[22,105],[102,106],[95,107],[71,108],[9,109],[53,110],[62,111],[110,112],[5,113],[27,114],[104,115],[35,116],[14,117],[0,118],[106,119],[37,120],[8,121],[26,122],[87,123],[49,124],[74,125],[61,126],[17,127],[89,128],[58,129],[33,130],[36,131],[50,132],[43,133],[121,134],[32,135],[113,136],[64,137],[73,138],[13,139],[133,140],[89,141],[36,142],[86,143],[117,144],[11,145],[70,146],[98,147],[82,148],[28,149],[61,150],[66,151],[59,152],[51,153],[49,154],[61,155],[76,156],[155,157],[57,158],[112,159],[19,160],[60,161],[88,162],[62,163],[52,164],[126,165],[48,166],[47,167],[136,168],[15,169],[7,170],[85,171],[61,172],[110,173],[81,174],[135,175],[60,176],[95,177],[171,178],[161,179],[44,180],[19,181],[175,182],[107,183],[23,184],[66,185],[122,186],[128,187],[147,188],[139,189],[135,190],[19,191],[103,192],[51,193],[158,194],[99,195],[75,196],[4,197],[26,198],[131,199],[167,200],[83,201],[131,202],[55,203],[32,204],[164,205],[98,206],[86,207],[170,208],[170,209],[188,210],[40,211],[46,212],[31,213],[18,214],[116,215],[13,216],[212,217],[148,218],[88,219],[19,220],[81,221],[137,222],[23,223],[58,224],[163,225],[145,226],[116,227],[45,228],[31,229],[47,230],[66,231],[82,232],[59,233],[229,234],[164,235],[122,236],[31,237],[143,238],[178,239],[32,240],[97,241],[89,242],[117,243],[191,244],[76,245],[25,246],[217,247],[106,248],[37,249],[12,250],[47,251],[163,252],[247,253],[253,254],[19,255],[245,256],[67,257],[108,258],[50,259],[115,260],[67,261],[248,262],[148,263],[149,264],[220,265],[54,266],[134,267],[2,268],[161,269],[265,270],[31,271],[83,272],[162,273],[267,274],[21,275],[72,276],[26,277],[112,278],[268,279],[41,280],[84,281],[196,282],[281,283],[109,284],[118,285],[66,286],[167,287],[142,288],[154,289],[262,290],[158,291],[216,292],[26,293],[30,294],[60,295],[276,296],[72,297],[215,298],[7,299],[69,300],[289,301],[54,302],[210,303],[280,304],[204,305],[186,306],[217,307],[305,308],[225,309],[13,310],[3,311],[110,312],[82,313],[155,314],[22,315],[66,316],[223,317],[252,318],[229,319],[247,320],[231,321],[190,322],[308,323],[26,324],[245,325],[123,326],[91,327],[308,328],[17,329],[78,330],[136,331],[7,332],[146,333],[318,334],[273,335],[161,336],[35,337],[241,338],[282,339],[133,340],[136,341],[8,342],[146,343],[117,344],[15,345],[102,346],[52,347],[21,348],[166,349],[131,350],[178,351],[142,352],[7,353],[255,354],[346,355],[162,356],[16,357],[253,358],[285,359],[23,360],[7,361],[96,362],[128,363],[231,364],[223,365],[275,366],[347,367],[244,368],[203,369],[55,370],[182,371],[170,372],[270,373],[315,374],[85,375],[346,376],[212,377],[102,378],[319,379],[252,380],[264,381],[351,382],[164,383],[233,384],[361,385],[175,386],[230,387],[331,388],[57,389],[119,390],[118,391],[251,392],[306,393],[255,394],[199,395],[238,396],[17,397],[197,398],[151,399],[356,400],[395,401],[191,402],[16,403],[13,404],[110,405],[313,406],[340,407],[161,408],[301,409],[44,410],[364,411],[272,412],[100,413],[312,414],[307,415],[347,416],[374,417],[187,418],[328,419],[118,420],[311,421],[321,422],[108,423],[395,424],[190,425],[299,426],[79,427],[68,428],[240,429],[386,430],[371,431],[5,432],[255,433],[320,434],[376,435],[81,436],[68,437],[54,438],[421,439],[423,440],[311,441],[41,442],[3,443],[400,444],[137,445],[253,446],[335,447],[376,448],[1,449],[212,450],[169,451],[383,452],[401,453],[383,454],[54,455],[59,456],[35,457],[121,458],[173,459],[388,460],[456,461],[81,462],[368,463],[219,464],[178,465],[114,466],[384,467],[104,468],[268,469],[170,470],[246,471],[319,472],[258,473],[326,474],[241,475],[25,476],[468,477],[444,478],[418,479],[405,480],[261,481],[447,482],[140,483],[30,484],[375,485],[75,486],[455,487],[64,488],[236,489],[454,490],[207,491],[431,492],[290,493],[84,494],[409,495],[315,496],[343,497],[480,498],[451,499],[155,500],[262,501],[111,502],[441,503],[237,504],[387,505],[275,506],[75,507],[259,508],[465,509],[433,510],[217,511],[450,512],[30,513],[479,514],[179,515],[102,516],[181,517],[153,518],[208,519],[380,520],[256,521],[276,522],[253,523],[417,524],[179,525],[305,526],[450,527],[407,528],[442,529],[99,530],[381,531],[89,532],[507,533],[347,534],[132,535],[445,536],[197,537],[255,538],[479,539],[322,540],[277,541],[342,542],[44,543],[443,544],[322,545],[96,546],[397,547],[195,548],[316,549],[13,550],[397,551],[405,552],[250,553],[365,554],[108,555],[213,556],[97,557],[406,558],[156,559],[421,560],[80,561],[328,562],[303,563],[243,564],[269,565],[485,566],[457,567],[371,568],[201,569],[337,570],[183,571],[221,572],[113,573],[447,574],[244,575],[429,576],[126,577],[69,578],[535,579],[303,580],[283,581],[567,582],[209,583],[21,584],[227,585],[21,586],[16,587],[268,588],[45,589],[107,590],[141,591],[40,592],[157,593],[328,594],[68,595],[225,596],[219,597],[301,598],[44,599],[515,600],[334,601],[229,602],[95,603],[177,604],[408,605],[119,606],[200,607],[334,608],[142,609],[437,610],[391,611],[272,612],[231,613],[566,614],[64,615],[186,616],[584,617],[9,618],[369,619],[21,620],[477,621],[17,622],[604,623],[228,624],[225,625],[615,626],[403,627],[90,628],[459,629],[171,630],[52,631],[626,632],[385,633],[96,634],[120,635],[161,636],[86,637],[14,638],[302,639],[402,640],[191,641],[355,642],[475,643],[267,644],[616,645],[10,646],[595,647],[295,648],[332,649],[78,650],[334,651],[402,652],[215,653],[328,654],[383,655],[461,656],[608,657],[590,658],[427,659],[115,660],[301,661],[579,662],[361,663],[602,664],[215,665],[181,666],[292,667],[126,668],[160,669],[640,670],[559,671],[301,672],[221,673],[226,674],[430,675],[403,676],[484,677],[395,678],[659,679],[169,680],[627,681],[48,682],[421,683],[589,684],[100,685],[662,686],[244,687],[440,688],[623,689],[626,690],[46,691],[148,692],[688,693],[87,694],[635,695],[609,696],[186,697],[317,698],[654,699],[412,700],[291,701],[481,702],[639,703],[596,704],[40,705],[382,706],[222,707],[445,708],[409,709],[612,710],[214,711],[658,712],[363,713],[399,714],[335,715],[274,716],[21,717],[109,718],[232,719],[551,720],[113,721],[78,722],[20,723],[172,724],[192,725],[291,726],[47,727],[378,728],[372,729],[349,730],[696,731],[362,732],[509,733],[603,734],[481,735],[633,736],[709,737],[610,738],[671,739],[525,740],[176,741],[329,742],[451,743],[23,744],[190,745],[473,746],[234,747],[470,748],[160,749],[599,750],[50,751],[176,752],[69,753],[525,754],[97,755],[692,756],[117,757],[364,758],[627,759],[393,760],[415,761],[222,762],[737,763],[461,764],[392,765],[28,766],[663,767],[274,768],[673,769],[607,770],[160,771],[222,772],[605,773],[342,774],[418,775],[269,776],[371,777],[235,778],[299,779],[725,780],[297,781],[233,782],[260,783],[214,784],[247,785],[170,786],[517,787],[612,788],[246,789],[52,790],[173,791],[490,792],[297,793],[451,794],[309,795],[65,796],[352,797],[178,798],[403,799],[338,800],[342,801],[282,802],[317,803],[361,804],[479,805],[141,806],[280,807],[303,808],[265,809],[172,810],[42,811],[39,812],[133,813],[339,814],[744,815],[765,816],[165,817],[323,818],[238,819],[95,820],[76,821],[37,822],[283,823],[410,824],[464,825],[666,826],[23,827],[669,828],[77,829],[512,830],[739,831],[813,832],[342,833],[18,834],[354,835],[641,836],[318,837],[480,838],[287,839],[521,840],[29,841],[224,842],[9,843],[119,844],[47,845],[291,846],[239,847],[249,848],[448,849],[347,850],[380,851],[354,852],[473,853],[55,854],[413,855],[635,856],[350,857],[454,858],[80,859],[550,860],[361,861],[660,862],[427,863],[535,864],[317,865],[162,866],[427,867],[732,868],[4,869],[611,870],[771,871],[311,872],[600,873],[809,874],[634,875],[618,876],[123,877],[373,878],[600,879],[686,880],[610,881],[361,882],[108,883],[397,884],[766,885],[440,886],[434,887],[627,888],[263,889],[316,890],[651,891],[668,892],[119,893],[696,894],[624,895],[133,896],[228,897],[71,898],[162,899],[496,900],[749,901],[802,902],[471,903],[117,904],[84,905],[212,906],[42,907],[351,908]]

n = 1010
edges = [[0,1],[0,2],[1,3],[0,4],[0,5],[1,6],[1,7],[5,8],[7,9],[6,10],[5,11],[9,12],[7,13],[7,14],[13,15],[15,16],[4,17],[3,18],[16,19],[0,20],[18,21],[15,22],[9,23],[14,24],[19,25],[1,26],[24,27],[25,28],[22,29],[2,30],[15,31],[11,32],[27,33],[9,34],[30,35],[6,36],[20,37],[8,38],[15,39],[23,40],[7,41],[20,42],[6,43],[9,44],[14,45],[13,46],[35,47],[36,48],[27,49],[7,50],[48,51],[8,52],[25,53],[50,54],[34,55],[32,56],[16,57],[17,58],[53,59],[12,60],[28,61],[4,62],[20,63],[49,64],[7,65],[4,66],[64,67],[24,68],[47,69],[1,70],[56,71],[33,72],[71,73],[56,74],[62,75],[18,76],[58,77],[12,78],[2,79],[15,80],[74,81],[31,82],[73,83],[6,84],[48,85],[13,86],[67,87],[72,88],[78,89],[44,90],[72,91],[87,92],[48,93],[68,94],[76,95],[41,96],[30,97],[18,98],[56,99],[16,100],[55,101],[47,102],[8,103],[11,104],[93,105],[88,106],[3,107],[44,108],[18,109],[48,110],[14,111],[94,112],[109,113],[5,114],[59,115],[47,116],[26,117],[83,118],[75,119],[80,120],[72,121],[78,122],[107,123],[122,124],[1,125],[40,126],[68,127],[5,128],[90,129],[14,130],[12,131],[40,132],[57,133],[1,134],[85,135],[23,136],[97,137],[20,138],[10,139],[40,140],[6,141],[135,142],[112,143],[38,144],[70,145],[86,146],[100,147],[103,148],[40,149],[110,150],[35,151],[142,152],[86,153],[102,154],[97,155],[53,156],[86,157],[16,158],[49,159],[101,160],[122,161],[28,162],[107,163],[28,164],[9,165],[45,166],[98,167],[83,168],[63,169],[46,170],[49,171],[154,172],[111,173],[79,174],[37,175],[42,176],[38,177],[107,178],[95,179],[90,180],[78,181],[66,182],[88,183],[93,184],[162,185],[156,186],[83,187],[43,188],[125,189],[16,190],[107,191],[138,192],[164,193],[75,194],[108,195],[30,196],[45,197],[92,198],[160,199],[138,200],[68,201],[94,202],[135,203],[102,204],[24,205],[50,206],[7,207],[142,208],[123,209],[78,210],[62,211],[3,212],[42,213],[63,214],[60,215],[113,216],[210,217],[180,218],[91,219],[77,220],[164,221],[178,222],[39,223],[218,224],[203,225],[12,226],[209,227],[172,228],[156,229],[42,230],[194,231],[40,232],[95,233],[131,234],[39,235],[135,236],[37,237],[61,238],[186,239],[134,240],[41,241],[206,242],[144,243],[15,244],[138,245],[191,246],[82,247],[174,248],[84,249],[28,250],[44,251],[171,252],[168,253],[112,254],[191,255],[132,256],[146,257],[30,258],[163,259],[178,260],[131,261],[80,262],[23,263],[202,264],[160,265],[203,266],[261,267],[254,268],[226,269],[97,270],[132,271],[6,272],[209,273],[18,274],[175,275],[165,276],[72,277],[234,278],[145,279],[233,280],[180,281],[216,282],[176,283],[160,284],[28,285],[21,286],[24,287],[264,288],[129,289],[118,290],[188,291],[209,292],[50,293],[266,294],[115,295],[122,296],[254,297],[171,298],[233,299],[143,300],[238,301],[88,302],[157,303],[98,304],[60,305],[275,306],[99,307],[150,308],[238,309],[155,310],[53,311],[212,312],[9,313],[163,314],[155,315],[285,316],[232,317],[155,318],[285,319],[141,320],[89,321],[246,322],[93,323],[173,324],[125,325],[17,326],[290,327],[94,328],[324,329],[94,330],[179,331],[101,332],[292,333],[229,334],[190,335],[111,336],[149,337],[292,338],[325,339],[26,340],[9,341],[236,342],[105,343],[133,344],[121,345],[143,346],[177,347],[285,348],[174,349],[290,350],[16,351],[302,352],[250,353],[95,354],[339,355],[10,356],[274,357],[156,358],[334,359],[113,360],[108,361],[177,362],[326,363],[229,364],[73,365],[118,366],[113,367],[336,368],[224,369],[174,370],[39,371],[356,372],[189,373],[280,374],[154,375],[359,376],[78,377],[175,378],[261,379],[185,380],[208,381],[211,382],[265,383],[60,384],[271,385],[304,386],[77,387],[171,388],[234,389],[343,390],[47,391],[367,392],[307,393],[25,394],[371,395],[38,396],[281,397],[308,398],[209,399],[9,400],[133,401],[234,402],[37,403],[237,404],[357,405],[62,406],[153,407],[254,408],[17,409],[388,410],[410,411],[401,412],[109,413],[107,414],[362,415],[300,416],[27,417],[106,418],[324,419],[165,420],[26,421],[330,422],[94,423],[172,424],[230,425],[64,426],[10,427],[93,428],[288,429],[253,430],[224,431],[430,432],[394,433],[356,434],[260,435],[121,436],[253,437],[369,438],[195,439],[30,440],[356,441],[381,442],[381,443],[61,444],[336,445],[164,446],[358,447],[115,448],[219,449],[434,450],[80,451],[108,452],[446,453],[188,454],[447,455],[260,456],[39,457],[31,458],[67,459],[218,460],[213,461],[450,462],[451,463],[259,464],[153,465],[103,466],[157,467],[151,468],[187,469],[73,470],[69,471],[60,472],[359,473],[469,474],[324,475],[460,476],[77,477],[167,478],[351,479],[196,480],[14,481],[326,482],[152,483],[455,484],[309,485],[45,486],[2,487],[403,488],[96,489],[433,490],[356,491],[449,492],[302,493],[466,494],[293,495],[428,496],[456,497],[108,498],[481,499],[352,500],[260,501],[322,502],[193,503],[354,504],[257,505],[278,506],[362,507],[311,508],[139,509],[138,510],[299,511],[307,512],[37,513],[175,514],[197,515],[135,516],[12,517],[49,518],[337,519],[86,520],[460,521],[232,522],[99,523],[253,524],[130,525],[514,526],[457,527],[30,528],[216,529],[73,530],[404,531],[284,532],[82,533],[440,534],[492,535],[206,536],[30,537],[21,538],[43,539],[429,540],[395,541],[507,542],[464,543],[52,544],[395,545],[339,546],[65,547],[423,548],[2,549],[190,550],[116,551],[288,552],[262,553],[155,554],[526,555],[279,556],[247,557],[129,558],[66,559],[43,560],[355,561],[415,562],[21,563],[142,564],[523,565],[135,566],[306,567],[154,568],[194,569],[461,570],[439,571],[63,572],[434,573],[29,574],[486,575],[571,576],[470,577],[366,578],[327,579],[40,580],[100,581],[310,582],[251,583],[229,584],[294,585],[108,586],[30,587],[110,588],[199,589],[487,590],[528,591],[249,592],[195,593],[420,594],[392,595],[111,596],[501,597],[127,598],[302,599],[44,600],[16,601],[448,602],[294,603],[521,604],[491,605],[424,606],[347,607],[572,608],[72,609],[532,610],[407,611],[366,612],[495,613],[557,614],[465,615],[361,616],[332,617],[606,618],[365,619],[435,620],[423,621],[207,622],[51,623],[603,624],[251,625],[192,626],[277,627],[223,628],[344,629],[64,630],[288,631],[576,632],[159,633],[387,634],[539,635],[47,636],[96,637],[115,638],[63,639],[268,640],[61,641],[77,642],[397,643],[461,644],[54,645],[605,646],[249,647],[456,648],[208,649],[487,650],[246,651],[546,652],[314,653],[325,654],[602,655],[469,656],[110,657],[412,658],[447,659],[181,660],[504,661],[24,662],[553,663],[176,664],[235,665],[94,666],[226,667],[336,668],[183,669],[191,670],[328,671],[350,672],[470,673],[158,674],[51,675],[208,676],[425,677],[463,678],[291,679],[574,680],[51,681],[303,682],[628,683],[482,684],[114,685],[429,686],[393,687],[188,688],[249,689],[485,690],[23,691],[590,692],[245,693],[310,694],[297,695],[593,696],[585,697],[46,698],[187,699],[388,700],[561,701],[114,702],[620,703],[421,704],[672,705],[161,706],[675,707],[235,708],[544,709],[367,710],[413,711],[152,712],[395,713],[701,714],[242,715],[656,716],[585,717],[687,718],[60,719],[338,720],[21,721],[53,722],[251,723],[46,724],[539,725],[602,726],[552,727],[488,728],[722,729],[455,730],[534,731],[153,732],[732,733],[520,734],[316,735],[279,736],[522,737],[549,738],[603,739],[136,740],[579,741],[279,742],[619,743],[272,744],[145,745],[413,746],[657,747],[676,748],[59,749],[193,750],[47,751],[93,752],[220,753],[608,754],[100,755],[44,756],[376,757],[8,758],[337,759],[200,760],[120,761],[113,762],[488,763],[77,764],[24,765],[226,766],[351,767],[488,768],[100,769],[495,770],[159,771],[617,772],[44,773],[318,774],[166,775],[532,776],[577,777],[22,778],[238,779],[609,780],[513,781],[514,782],[687,783],[271,784],[118,785],[522,786],[643,787],[441,788],[202,789],[575,790],[176,791],[197,792],[503,793],[760,794],[716,795],[585,796],[99,797],[432,798],[781,799],[10,800],[165,801],[781,802],[587,803],[315,804],[694,805],[337,806],[295,807],[711,808],[226,809],[556,810],[783,811],[205,812],[9,813],[294,814],[340,815],[542,816],[332,817],[118,818],[786,819],[525,820],[666,821],[163,822],[31,823],[115,824],[591,825],[295,826],[232,827],[564,828],[246,829],[336,830],[398,831],[562,832],[810,833],[174,834],[22,835],[817,836],[568,837],[806,838],[373,839],[141,840],[296,841],[589,842],[180,843],[733,844],[366,845],[225,846],[356,847],[397,848],[763,849],[193,850],[693,851],[47,852],[647,853],[736,854],[830,855],[854,856],[232,857],[572,858],[427,859],[63,860],[349,861],[520,862],[658,863],[341,864],[511,865],[85,866],[261,867],[268,868],[763,869],[462,870],[55,871],[267,872],[844,873],[116,874],[346,875],[424,876],[14,877],[715,878],[819,879],[288,880],[805,881],[679,882],[745,883],[772,884],[569,885],[408,886],[548,887],[786,888],[64,889],[506,890],[779,891],[782,892],[509,893],[486,894],[326,895],[102,896],[757,897],[45,898],[481,899],[756,900],[335,901],[415,902],[608,903],[523,904],[787,905],[777,906],[268,907],[860,908],[512,909],[42,910],[261,911],[428,912],[62,913],[126,914],[849,915],[227,916],[12,917],[357,918],[755,919],[324,920],[86,921],[244,922],[493,923],[224,924],[622,925],[732,926],[873,927],[697,928],[31,929],[583,930],[414,931],[756,932],[82,933],[638,934],[172,935],[435,936],[806,937],[179,938],[648,939],[205,940],[864,941],[761,942],[253,943],[611,944],[500,945],[454,946],[644,947],[406,948],[757,949],[381,950],[832,951],[503,952],[681,953],[667,954],[337,955],[374,956],[360,957],[803,958],[120,959],[546,960],[265,961],[614,962],[885,963],[749,964],[733,965],[691,966],[640,967],[118,968],[425,969],[408,970],[855,971],[737,972],[565,973],[512,974],[673,975],[251,976],[232,977],[526,978],[586,979],[174,980],[379,981],[74,982],[256,983],[494,984],[806,985],[887,986],[892,987],[748,988],[257,989],[721,990],[281,991],[309,992],[652,993],[591,994],[569,995],[187,996],[989,997],[959,998],[63,999],[703,1000],[436,1001],[591,1002],[400,1003],[810,1004],[797,1005],[981,1006],[33,1007],[999,1008],[358,1009]]

#n = 2
#edges = [[0,1]]

print Solution().findMinHeightTrees(n, edges)